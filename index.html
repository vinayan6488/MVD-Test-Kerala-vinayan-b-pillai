<!DOCTYPE html>
<html lang="ml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MVD Driving Test Kerala (Online Practice)</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Base Styles */
        body {
            font-family: 'Noto Sans Malayalam', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            text-align: center;
            transition: all 0.3s ease-in-out;
        }
        .header {
            background-color: #dc3545;
            color: white;
            padding: 15px;
            margin: -30px -30px 20px -30px;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
            font-size: 1.5rem;
            font-weight: 700;
        }
        h2 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        /* Input and Button Styles */
        input[type="text"], input[type="password"] {
            width: calc(100% - 20px);
            padding: 12px;
            margin: 10px 0 20px 0;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1rem;
            font-family: 'Noto Sans Malayalam', sans-serif;
        }
        .main-button {
            width: 100%;
            padding: 12px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        .main-button:hover {
            background-color: #0056b3;
        }
        .error-message {
            color: #dc3545;
            margin-top: 10px;
            font-weight: 700;
        }

        /* Test Window Styles */
        .question-box {
            margin-bottom: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }
        #current-question {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
        }
        .option-button {
            width: 100%;
            padding: 15px;
            margin: 8px 0;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fff;
            text-align: left;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s, border-color 0.3s;
            font-family: 'Noto Sans Malayalam', sans-serif;
        }
        .option-button:hover {
            background-color: #e9ecef;
            border-color: #007bff;
        }
        .option-button strong {
            margin-right: 10px;
            color: #007bff;
        }
        .timer-display {
            font-size: 2rem;
            font-weight: 700;
            color: #dc3545;
            margin-bottom: 20px;
        }
        .timer-label {
            font-size: 0.9rem;
            color: #6c757d;
        }

        /* Image Display */
        #question-image {
            max-width: 100%;
            height: auto;
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        /* Result Window Styles */
        #result-message {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
        }
        #final-score {
            font-size: 1.2rem;
            color: #6c757d;
        }

        /* Utility */
        .hidden {
            display: none;
        }
        .lang-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 12px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            z-index: 100;
        }
        .lang-toggle:hover {
            background-color: #5a6268;
        }

        /* Footer for Key Input Info */
        .footer-info {
            margin-top: 20px;
            font-size: 0.85rem;
            color: #6c757d;
        }
        .key-info {
            display: block;
            margin-top: 5px;
            font-weight: bold;
        }
        
        /* Mobile adjustments */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
                border-radius: 6px;
            }
            .header {
                font-size: 1.2rem;
                margin: -20px -20px 15px -20px;
                border-top-left-radius: 6px;
                border-top-right-radius: 6px;
            }
        }
    </style>
</head>
<body>

    <button class="lang-toggle" onclick="toggleLanguage()">English / ‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>

    <div class="container">
        <div id="front-page" class="window hidden">
            <div class="header" data-ml="‡¥ï‡µá‡¥∞‡¥≥ ‡¥Æ‡µã‡¥ü‡µç‡¥ü‡µã‡µº ‡¥µ‡¥æ‡¥π‡¥® ‡¥µ‡¥ï‡µÅ‡¥™‡µç‡¥™‡µç" data-en="KERALA MOTOR VEHICLES DEPARTMENT">‡¥ï‡µá‡¥∞‡¥≥ ‡¥Æ‡µã‡¥ü‡µç‡¥ü‡µã‡µº ‡¥µ‡¥æ‡¥π‡¥® ‡¥µ‡¥ï‡µÅ‡¥™‡µç‡¥™‡µç</div>
            <h2>Driving Test Practice (Mock Exam)</h2>
            <p data-ml="‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥≤‡µá‡¥£‡µá‡¥¥‡µç‚Äå‡¥∏‡µç ‡¥≤‡µà‡¥∏‡µª‡¥∏‡µç ‡¥ü‡µÜ‡¥∏‡µç‡¥±‡µç‡¥±‡µç ‡¥™‡¥∞‡¥ø‡¥∂‡µÄ‡¥≤‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µç ‡¥§‡¥æ‡¥¥‡µÜ‡¥Ø‡µÅ‡¥≥‡µç‡¥≥ ‡¥¨‡¥ü‡µç‡¥ü‡µ∫ ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï. ‡¥™‡¥∞‡¥ø‡¥∂‡µÄ‡¥≤‡¥®‡¥Ç ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µç ‡¥Æ‡µÅ‡¥Æ‡µç‡¥™‡µç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥ï‡µã‡¥°‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥Ü‡¥ï‡µç‡¥ü‡¥ø‡¥µ‡µá‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï." data-en="Use the button below to practice for your Learner's License Test. Activate with your Login Code before starting the practice.">‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥≤‡µá‡¥£‡µá‡¥¥‡µç‚Äå‡¥∏‡µç ‡¥≤‡µà‡¥∏‡µª‡¥∏‡µç ‡¥ü‡µÜ‡¥∏‡µç‡¥±‡µç‡¥±‡µç ‡¥™‡¥∞‡¥ø‡¥∂‡µÄ‡¥≤‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µç ‡¥§‡¥æ‡¥¥‡µÜ‡¥Ø‡µÅ‡¥≥‡µç‡¥≥ ‡¥¨‡¥ü‡µç‡¥ü‡µ∫ ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï. ‡¥™‡¥∞‡¥ø‡¥∂‡µÄ‡¥≤‡¥®‡¥Ç ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µç ‡¥Æ‡µÅ‡¥Æ‡µç‡¥™‡µç ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥ï‡µã‡¥°‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥Ü‡¥ï‡µç‡¥ü‡¥ø‡¥µ‡µá‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï.</p>
            <button class="main-button" onclick="showActivationWindow()" data-ml="‡¥™‡¥∞‡¥ø‡¥∂‡µÄ‡¥≤‡¥®‡¥Ç ‡¥§‡µÅ‡¥ü‡¥ô‡µç‡¥ô‡µÅ‡¥ï" data-en="Start Practice">‡¥™‡¥∞‡¥ø‡¥∂‡µÄ‡¥≤‡¥®‡¥Ç ‡¥§‡µÅ‡¥ü‡¥ô‡µç‡¥ô‡µÅ‡¥ï</button>
        </div>

        <div id="activation-window" class="window hidden">
            <div class="header" data-ml="‡¥Ü‡¥ï‡µç‡¥ü‡¥ø‡¥µ‡µá‡¥∑‡µª ‡¥ï‡µã‡¥°‡µç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï" data-en="Enter Activation Code">‡¥Ü‡¥ï‡µç‡¥ü‡¥ø‡¥µ‡µá‡¥∑‡µª ‡¥ï‡µã‡¥°‡µç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï</div>
            <label for="activation-code" data-ml="‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥ï‡µã‡¥°‡µç (Login Code):" data-en="Login Code (Login Code):">‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥ï‡µã‡¥°‡µç (Login Code):</label>
            <input type="password" id="activation-code" placeholder="‡¥ï‡µã‡¥°‡µç ‡¥á‡¥µ‡¥ø‡¥ü‡µÜ ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï" required>
            <button class="main-button" onclick="checkActivationCode()" data-ml="‡¥§‡µÅ‡¥ü‡¥∞‡µÅ‡¥ï" data-en="Continue">‡¥§‡µÅ‡¥ü‡¥∞‡µÅ‡¥ï</button>
            <p id="activation-error" class="error-message hidden" data-ml="‡¥ï‡µã‡¥°‡µç ‡¥§‡µÜ‡¥±‡µç‡¥±‡¥æ‡¥£‡µç. ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï." data-en="Incorrect code. Please try again.">‡¥ï‡µã‡¥°‡µç ‡¥§‡µÜ‡¥±‡µç‡¥±‡¥æ‡¥£‡µç. ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.</p>
        </div>
        
        <div id="unauthorized-container" class="window hidden">
            <div class="header">üö´ ‡¥®‡¥ø‡¥Ø‡¥Æ‡¥≤‡¥Ç‡¥ò‡¥®‡¥Ç üö´</div>
            <h2 style="color: #dc3545;">‚ö†Ô∏è ‡¥ï‡¥ü‡µÅ‡¥™‡µç‡¥™‡¥Æ‡µá‡¥±‡¥ø‡¥Ø ‡¥≤‡µà‡¥∏‡µª‡¥∏‡µç ‡¥ö‡µÜ‡¥ï‡µç‡¥ï‡µç ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡µÅ</h2>
            <p data-ml="‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ï‡µã‡¥°‡¥ø‡µΩ ‡¥Æ‡¥æ‡¥±‡µç‡¥±‡¥ô‡µç‡¥ô‡µæ ‡¥µ‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥§‡¥æ‡¥Ø‡¥ø ‡¥ï‡¥æ‡¥£‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥à ‡¥™‡µç‡¥∞‡µã‡¥ó‡µç‡¥∞‡¥æ‡¥Ç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µç ‡¥Æ‡µÅ‡¥Æ‡µç‡¥™‡µç ‡¥ï‡µã‡¥°‡µç ‡¥ï‡µÉ‡¥§‡µç‡¥Ø‡¥Æ‡¥æ‡¥£‡µÜ‡¥®‡µç‡¥®‡µç ‡¥â‡¥±‡¥™‡µç‡¥™‡µÅ‡¥µ‡¥∞‡µÅ‡¥§‡µç‡¥§‡µÅ‡¥ï." data-en="Changes have been detected in your code. Ensure the code is correct before using this program.">‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ï‡µã‡¥°‡¥ø‡µΩ ‡¥Æ‡¥æ‡¥±‡µç‡¥±‡¥ô‡µç‡¥ô‡µæ ‡¥µ‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥§‡¥æ‡¥Ø‡¥ø ‡¥ï‡¥æ‡¥£‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥à ‡¥™‡µç‡¥∞‡µã‡¥ó‡µç‡¥∞‡¥æ‡¥Ç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µç ‡¥Æ‡µÅ‡¥Æ‡µç‡¥™‡µç ‡¥ï‡µã‡¥°‡µç ‡¥ï‡µÉ‡¥§‡µç‡¥Ø‡¥Æ‡¥æ‡¥£‡µÜ‡¥®‡µç‡¥®‡µç ‡¥â‡¥±‡¥™‡µç‡¥™‡µÅ‡¥µ‡¥∞‡µÅ‡¥§‡µç‡¥§‡µÅ‡¥ï.</p>
        </div>


        <div id="user-details-window" class="window hidden">
            <div class="header" data-ml="‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï" data-en="Enter Details">‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï</div>
            <label for="user-name" data-ml="‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç:" data-en="Your Name:">‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç:</label>
            <input type="text" id="user-name" placeholder="‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç" required>
            <button class="main-button" onclick="startExamFlow()" data-ml="‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑ ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï" data-en="Start Exam">‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑ ‡¥Ü‡¥∞‡¥Ç‡¥≠‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï</button>
        </div>

        <div id="test-window" class="window hidden">
            <div class="header" data-ml="‡¥≤‡µá‡¥£‡µá‡¥¥‡µç‚Äå‡¥∏‡µç ‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑" data-en="Learner's Exam">‡¥≤‡µá‡¥£‡µá‡¥¥‡µç‚Äå‡¥∏‡µç ‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑</div>
            <div class="timer-label" data-ml="‡¥∏‡¥Æ‡¥Ø‡¥Ç ‡¥¨‡¥æ‡¥ï‡µç‡¥ï‡¥ø" data-en="Time Remaining">‡¥∏‡¥Æ‡¥Ø‡¥Ç ‡¥¨‡¥æ‡¥ï‡µç‡¥ï‡¥ø</div>
            <div class="timer-display"><span id="timer">30</span>s</div>
            
            <div class="question-box">
                <p id="question-number" style="color: #007bff; font-weight: 700;">‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç 1 / 30</p>
                <img id="question-image" class="hidden" alt="Traffic Sign">
                <p id="current-question">‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç ‡¥á‡¥µ‡¥ø‡¥ü‡µÜ ‡¥µ‡¥∞‡µÅ‡¥Ç?</p>
            </div>
            
            <div id="options-container">
                </div>
            <div class="footer-info">
                <p data-ml="‡¥ï‡µÄ‡¥¨‡µã‡µº‡¥°‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥µ‡µº‡¥ï‡µç‡¥ï‡µç:" data-en="For Keyboard Users:">‡¥ï‡µÄ‡¥¨‡µã‡µº‡¥°‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥µ‡µº‡¥ï‡µç‡¥ï‡µç:
                    <span class="key-info" data-ml="‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡¥æ‡µª 1, 2, 3, ‡¥Ö‡¥≤‡µç‡¥≤‡µÜ‡¥ô‡µç‡¥ï‡¥ø‡µΩ 4 ‡¥Ö‡¥Æ‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï." data-en="Press 1, 2, 3, or 4 to select the answer.">‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡¥æ‡µª 1, 2, 3, ‡¥Ö‡¥≤‡µç‡¥≤‡µÜ‡¥ô‡µç‡¥ï‡¥ø‡µΩ 4 ‡¥Ö‡¥Æ‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï.</span>
                </p>
            </div>
        </div>

        <div id="result-window" class="window hidden">
            <div class="header" data-ml="‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥æ ‡¥´‡¥≤‡¥Ç" data-en="Exam Result">‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥æ ‡¥´‡¥≤‡¥Ç</div>
            <p id="result-message"></p>
            <p id="final-score"></p>
            <button class="main-button" onclick="location.reload()" data-ml="‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï" data-en="Try Again">‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï</button>
        </div>
    </div>

    <script>
        // ******************************************************
        //             üîí ‡¥Ü‡¥ï‡µç‡¥ü‡¥ø‡¥µ‡µá‡¥∑‡µª ‡¥ï‡µã‡¥°‡µç ‡¥ö‡µÜ‡¥ï‡µç‡¥ï‡µç ‡¥≤‡µã‡¥ú‡¥ø‡¥ï‡µç (‡¥≤‡¥ò‡µÇ‡¥ï‡¥∞‡¥ø‡¥ö‡µç‡¥ö‡¥§‡µç) üîí
        // ******************************************************
        
        // 1. ‡¥é‡¥≥‡µÅ‡¥™‡µç‡¥™‡¥§‡µç‡¥§‡¥ø‡µΩ ‡¥Æ‡¥æ‡¥±‡µç‡¥±‡¥æ‡µª ‡¥™‡¥æ‡¥ü‡¥ø‡¥≤‡µç‡¥≤‡¥æ‡¥§‡µç‡¥§ ‡¥ï‡µã‡¥°‡µç (‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥ï‡µã‡¥°‡µç: dturns)
        const ORIGINAL_CODE_BASE = "dturns";
        
        // 2. ‡¥ï‡¥ü‡µÅ‡¥™‡µç‡¥™‡¥Æ‡µá‡¥±‡¥ø‡¥Ø SHA-256 ‡¥π‡¥æ‡¥∑‡µç ‡¥ö‡µÜ‡¥ï‡µç‡¥ï‡µç ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡¥ø, ‡¥®‡µá‡¥∞‡¥ø‡¥ü‡µç‡¥ü‡µÅ‡¥≥‡µç‡¥≥ ‡¥§‡¥æ‡¥∞‡¥§‡¥Æ‡µç‡¥Ø‡¥Ç ‡¥Æ‡¥æ‡¥§‡µç‡¥∞‡¥Ç ‡¥Æ‡¥§‡¥ø‡¥Ø‡¥æ‡¥ï‡µÅ‡¥Ç.
        async function checkCodeIntegrity(inputCode) {
            if (!inputCode) return false;

            // ‡¥®‡µΩ‡¥ï‡¥ø‡¥Ø ‡¥ï‡µã‡¥°‡µç ORIGINAL_CODE_BASE-‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥™‡µä‡¥∞‡µÅ‡¥§‡µç‡¥§‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥®‡µç‡¥®‡µÅ‡¥£‡µç‡¥ü‡µã ‡¥é‡¥®‡µç‡¥®‡µç ‡¥Æ‡¥æ‡¥§‡µç‡¥∞‡¥Ç ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ.
            // SHA-256 ‡¥π‡¥æ‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥ö‡µÜ‡¥ï‡µç‡¥ï‡µç ‡¥™‡µÇ‡µº‡¥£‡µç‡¥£‡¥Æ‡¥æ‡¥Ø‡µÅ‡¥Ç ‡¥í‡¥¥‡¥ø‡¥µ‡¥æ‡¥ï‡µç‡¥ï‡¥ø‡¥Ø‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ.
            return inputCode.toLowerCase().trim() === ORIGINAL_CODE_BASE.toLowerCase();
        }

        // ******************************************************
        //                   ‚öôÔ∏è ‡¥Æ‡¥±‡µç‡¥±‡µÅ ‡¥ï‡µã‡¥°‡µÅ‡¥ï‡µæ ‚öôÔ∏è
        // ******************************************************

        const LOCAL_STORAGE_KEY = "MVD_ACTIVATION_STATUS";
        let isActivated = localStorage.getItem(LOCAL_STORAGE_KEY) === "TRUE";

        let userName = "";
        let questions = [];
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let timerInterval;
        let audioContext;
        let consecutiveCorrectAnswers = 0;
        let currentLang = 'ml'; // Default language

        // --- Translations Dictionary ---
        const translations = {
            ml: {
                question_label: "‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç", of: " / ", fail_time: "‡¥∏‡¥Æ‡¥Ø‡¥Ç ‡¥ï‡¥¥‡¥ø‡¥û‡µç‡¥û‡µÅ! ‡¥â‡¥§‡µç‡¥§‡¥∞‡¥Ç ‡¥§‡µÜ‡¥±‡µç‡¥±‡¥æ‡¥Ø‡¥ø ‡¥ï‡¥£‡¥ï‡µç‡¥ï‡¥æ‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ.",
                fail_license: "‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥ï‡µã‡¥°‡µç ‡¥§‡µÜ‡¥±‡µç‡¥±‡¥æ‡¥£‡µç. ‡¥Ü‡¥ï‡µç‡¥ü‡¥ø‡¥µ‡µá‡¥∑‡µª ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡µÅ.",
                pass_message: "‡¥§‡¥æ‡¥ô‡µç‡¥ï‡µæ ‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥Ø‡¥ø‡µΩ ‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ.", fail_message: "‡¥§‡¥æ‡¥ô‡µç‡¥ï‡µæ ‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥Ø‡¥ø‡µΩ ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ. ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.",
                score_correct: "‡¥∂‡¥∞‡¥ø ‡¥â‡¥§‡µç‡¥§‡¥∞‡¥ô‡µç‡¥ô‡µæ", input_alert: "‡¥™‡µá‡¥∞‡µç ‡¥∂‡¥∞‡¥ø‡¥Ø‡¥æ‡¥Ø‡¥ø ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï.",
                placeholder_name: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç"
            },
            en: {
                question_label: "Question", of: " / ", fail_time: "Time's up! Answer is considered incorrect.",
                fail_license: "Incorrect Login Code. Activation failed.",
                pass_message: "You have passed the exam.", fail_message: "You have failed the exam. Please try again.",
                score_correct: "Correct Answers", input_alert: "Please enter your Name correctly.",
                placeholder_name: "Your Name"
            }
        };

        // --- MVD Questions Data (30 Questions) --- (Same as before, using images where available)
        const allMvdQuestions = [
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï", "‡¥™‡µç‡¥∞‡¥µ‡µá‡¥∂‡¥®‡¥Ç ‡¥á‡¥≤‡µç‡¥≤", "‡¥µ‡¥¥‡¥ø ‡¥ï‡µä‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï"], correct: "‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï" }, en: { q: "What does this sign indicate?", options: ["STOP", "No Entry", "Give Way"], correct: "STOP" }, image: "stop.png" },
            { ml: { q: "‡¥µ‡¥æ‡¥π‡¥®‡¥Ç ‡¥ì‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥Æ‡µç‡¥™‡µã‡µæ ‡¥Æ‡µä‡¥¨‡µà‡µΩ ‡¥´‡µã‡µ∫ ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥Æ‡µã?", options: ["‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥Ç", "‡¥π‡µÜ‡¥°‡µç‚Äå‡¥∏‡µÜ‡¥±‡µç‡¥±‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥Ç", "‡¥™‡¥æ‡¥ü‡¥ø‡¥≤‡µç‡¥≤"], correct: "‡¥™‡¥æ‡¥ü‡¥ø‡¥≤‡µç‡¥≤" }, en: { q: "Is mobile phone use allowed while driving?", options: ["Yes", "Yes, with headset", "No"], correct: "No" } },
            { ml: { q: "‡¥≤‡µá‡¥£‡µá‡¥¥‡µç‡¥∏‡µç ‡¥≤‡µà‡¥∏‡µª‡¥∏‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥ß‡¥ø ‡¥é‡¥§‡µç‡¥∞‡¥Ø‡¥æ‡¥£‡µç?", options: ["6 ‡¥Æ‡¥æ‡¥∏‡¥Ç", "1 ‡¥µ‡µº‡¥∑‡¥Ç", "3 ‡¥Æ‡¥æ‡¥∏‡¥Ç"], correct: "6 ‡¥Æ‡¥æ‡¥∏‡¥Ç" }, en: { q: "What is the validity of a Learner's License?", options: ["6 Months", "1 Year", "3 Months"], correct: "6 Months" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥π‡µã‡µ∫ ‡¥®‡¥ø‡µº‡¥¨‡¥®‡µç‡¥ß‡¥Ç", "‡¥π‡µã‡µ∫ ‡¥Ö‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥™‡¥æ‡¥ü‡¥ø‡¥≤‡µç‡¥≤", "‡¥∂‡¥¨‡µç‡¥¶‡¥Æ‡µÅ‡¥£‡µç‡¥ü‡¥æ‡¥ï‡µç‡¥ï‡¥∞‡µÅ‡¥§‡µç"], correct: "‡¥π‡µã‡µ∫ ‡¥Ö‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥™‡¥æ‡¥ü‡¥ø‡¥≤‡µç‡¥≤" }, en: { q: "What does this sign indicate?", options: ["Horn Compulsory", "No Horn", "Do not make noise"], correct: "No Horn" }, image: "no_horn.png" },
            { ml: { q: "‡¥Ö‡¥™‡¥ï‡¥ü‡¥Æ‡µÅ‡¥£‡µç‡¥ü‡¥æ‡¥Ø‡¥æ‡µΩ ‡¥â‡¥ü‡µª ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µá‡¥£‡µç‡¥ü‡¥§‡µç ‡¥é‡¥®‡µç‡¥§‡µç?", options: ["‡¥™‡µã‡¥≤‡µÄ‡¥∏‡¥ø‡µΩ ‡¥Ö‡¥±‡¥ø‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï, ‡¥™‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥±‡µç‡¥±‡¥µ‡µº‡¥ï‡µç‡¥ï‡µç ‡¥µ‡µà‡¥¶‡µç‡¥Ø‡¥∏‡¥π‡¥æ‡¥Ø‡¥Ç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï", "‡¥∏‡µç‡¥•‡¥≤‡¥Ç ‡¥µ‡¥ø‡¥ü‡µÅ‡¥ï", "‡¥µ‡¥æ‡¥π‡¥®‡¥Ç ‡¥í‡¥§‡µÅ‡¥ï‡µç‡¥ï‡¥ø ‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï"], correct: "‡¥™‡µã‡¥≤‡µÄ‡¥∏‡¥ø‡µΩ ‡¥Ö‡¥±‡¥ø‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï, ‡¥™‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥±‡µç‡¥±‡¥µ‡µº‡¥ï‡µç‡¥ï‡µç ‡¥µ‡µà‡¥¶‡µç‡¥Ø‡¥∏‡¥π‡¥æ‡¥Ø‡¥Ç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï" }, en: { q: "What to do immediately after an accident?", options: ["Inform police and give medical aid to injured", "Leave the spot", "Park the vehicle aside"], correct: "Inform police and give medical aid to injured" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥§‡¥ø‡¥∞‡¥ø‡¥Ø‡¥æ‡¥Ç", "‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥§‡¥ø‡¥∞‡¥ø‡¥Ø‡¥∞‡µÅ‡¥§‡µç", "‡¥®‡µá‡¥∞‡µÜ ‡¥™‡µã‡¥ï‡µÅ‡¥ï"], correct: "‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥§‡¥ø‡¥∞‡¥ø‡¥Ø‡¥∞‡µÅ‡¥§‡µç" }, en: { q: "What does this sign indicate?", options: ["Right turn allowed", "No Right Turn", "Go Straight"], correct: "No Right Turn" }, image: "no_right_turn.png" },
            { ml: { q: "‡¥á‡µª‡µç‡¥±‡µº‡¥∏‡µÜ‡¥ï‡µç‡¥∑‡¥®‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ ‡¥è‡¥§‡µç ‡¥µ‡¥æ‡¥π‡¥®‡¥§‡µç‡¥§‡¥ø‡¥®‡¥æ‡¥£‡µç ‡¥Æ‡µÅ‡µª‡¥ó‡¥£‡¥®?", options: ["‡¥µ‡¥≤‡¥§‡µÅ‡¥µ‡¥∂‡¥§‡µç‡¥§‡µç ‡¥®‡¥ø‡¥®‡µç‡¥®‡µç ‡¥µ‡¥∞‡µÅ‡¥®‡µç‡¥® ‡¥µ‡¥æ‡¥π‡¥®‡¥§‡µç‡¥§‡¥ø‡¥®‡µç", "‡¥á‡¥ü‡¥§‡µÅ‡¥µ‡¥∂‡¥§‡µç‡¥§‡µç ‡¥®‡¥ø‡¥®‡µç‡¥®‡µç ‡¥µ‡¥∞‡µÅ‡¥®‡µç‡¥® ‡¥µ‡¥æ‡¥π‡¥®‡¥§‡µç‡¥§‡¥ø‡¥®‡µç", "‡¥≤‡µà‡¥±‡µç‡¥±‡µç ‡¥µ‡¥æ‡¥π‡¥®‡¥§‡µç‡¥§‡¥ø‡¥®‡µç"], correct: "‡¥µ‡¥≤‡¥§‡µÅ‡¥µ‡¥∂‡¥§‡µç‡¥§‡µç ‡¥®‡¥ø‡¥®‡µç‡¥®‡µç ‡¥µ‡¥∞‡µÅ‡¥®‡µç‡¥® ‡¥µ‡¥æ‡¥π‡¥®‡¥§‡µç‡¥§‡¥ø‡¥®‡µç" }, en: { q: "Which vehicle has priority at intersections?", options: ["Vehicle from the right side", "Vehicle from the left side", "Light vehicle"], correct: "Vehicle from the right side" } },
            { ml: { q: "‡¥™‡¥æ‡µº‡¥ï‡µç‡¥ï‡¥ø‡¥Ç‡¥ó‡µç ‡¥®‡¥ø‡¥∞‡µã‡¥ß‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥ü‡µç‡¥ü‡µÅ‡¥≥‡µç‡¥≥ ‡¥∏‡µç‡¥•‡¥≤‡¥Ç?", options: ["‡¥¨‡¥∏‡µç ‡¥∏‡µç‡¥±‡µç‡¥±‡µã‡¥™‡µç‡¥™‡¥ø‡µΩ", "‡¥µ‡µÄ‡¥ü‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥Æ‡µÅ‡¥±‡µç‡¥±‡¥§‡µç‡¥§‡µç", "‡¥±‡µã‡¥°‡¥∞‡¥ø‡¥ï‡¥ø‡µΩ"], correct: "‡¥¨‡¥∏‡µç ‡¥∏‡µç‡¥±‡µç‡¥±‡µã‡¥™‡µç‡¥™‡¥ø‡µΩ" }, en: { q: "Where is parking prohibited?", options: ["At a Bus Stop", "In a house yard", "On the roadside"], correct: "At a Bus Stop" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥∏‡µç‡¥ï‡µÇ‡µæ ‡¥∏‡¥Æ‡µÄ‡¥™‡¥Ç", "‡¥Ü‡¥∂‡µÅ‡¥™‡¥§‡µç‡¥∞‡¥ø ‡¥∏‡¥Æ‡µÄ‡¥™‡¥Ç", "‡¥±‡µÜ‡¥Ø‡¥ø‡µΩ‡¥µ‡µá ‡¥ï‡µç‡¥∞‡µã‡¥∏‡¥ø‡¥Ç‡¥ó‡µç"], correct: "‡¥∏‡µç‡¥ï‡µÇ‡µæ ‡¥∏‡¥Æ‡µÄ‡¥™‡¥Ç" }, en: { q: "What does this sign indicate?", options: ["School Ahead", "Hospital Ahead", "Railway Crossing"], correct: "School Ahead" }, image: "school.png" },
            { ml: { q: "‡¥µ‡¥æ‡¥π‡¥®‡¥Ç ‡¥ì‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥Æ‡µç‡¥™‡µã‡µæ ‡¥™‡¥æ‡¥≤‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥£‡µç‡¥ü ‡¥µ‡µá‡¥ó‡¥§?", options: ["‡¥®‡¥ø‡¥Ø‡¥Æ‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥∂‡¥æ‡¥∏‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥® ‡¥µ‡µá‡¥ó‡¥§", "‡¥±‡µã‡¥°‡¥ø‡¥≤‡µÜ ‡¥ó‡¥§‡¥æ‡¥ó‡¥§‡¥Æ‡¥®‡µÅ‡¥∏‡¥∞‡¥ø‡¥ö‡µç‡¥ö‡µç", "‡¥™‡¥∞‡¥ø‡¥ß‡¥ø ‡¥®‡¥ø‡¥∂‡µç‡¥ö‡¥Ø‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥ü‡µç‡¥ü‡¥ø‡¥≤‡µç‡¥≤"], correct: "‡¥®‡¥ø‡¥Ø‡¥Æ‡¥Ç ‡¥Ö‡¥®‡µÅ‡¥∂‡¥æ‡¥∏‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥® ‡¥µ‡µá‡¥ó‡¥§" }, en: { q: "What speed should be maintained while driving?", options: ["Speed prescribed by law", "Speed based on road traffic", "No limit defined"], correct: "Speed prescribed by law" } },
            { ml: { q: "‡¥ü‡µç‡¥∞‡¥æ‡¥´‡¥ø‡¥ï‡µç ‡¥≤‡µà‡¥±‡µç‡¥±‡¥ø‡µΩ ‡¥Æ‡¥û‡µç‡¥û ‡¥≤‡µà‡¥±‡µç‡¥±‡µç ‡¥ï‡¥£‡µç‡¥ü‡¥æ‡µΩ?", options: ["‡¥µ‡µá‡¥ó‡¥§ ‡¥ï‡µÇ‡¥ü‡µç‡¥ü‡µÅ‡¥ï", "‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡¥æ‡µª ‡¥§‡¥Ø‡µç‡¥Ø‡¥æ‡¥±‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï", "‡¥™‡µã‡¥µ‡µÅ‡¥ï"], correct: "‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡¥æ‡µª ‡¥§‡¥Ø‡µç‡¥Ø‡¥æ‡¥±‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï" }, en: { q: "What does a yellow light in a traffic signal mean?", options: ["Increase speed", "Prepare to stop", "Proceed"], correct: "Prepare to stop" } },
            { ml: { q: "‡¥≤‡µà‡¥∏‡µª‡¥∏‡µç ‡¥á‡¥≤‡µç‡¥≤‡¥æ‡¥§‡µÜ ‡¥µ‡¥æ‡¥π‡¥®‡¥Ç ‡¥ì‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡µç?", options: ["‡¥ï‡µÅ‡¥±‡µç‡¥±‡¥ï‡¥∞‡¥Æ‡¥≤‡µç‡¥≤", "‡¥™‡¥ø‡¥¥‡¥Ø‡¥ü‡¥ï‡µç‡¥ï‡¥£‡¥Ç", "‡¥ï‡µÅ‡¥±‡µç‡¥±‡¥ï‡¥∞‡¥Æ‡¥æ‡¥£‡µç"], correct: "‡¥ï‡µÅ‡¥±‡µç‡¥±‡¥ï‡¥∞‡¥Æ‡¥æ‡¥£‡µç" }, en: { q: "Driving a vehicle without a license is?", options: ["Not an offense", "Punishable with fine", "An offense"], correct: "An offense" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥µ‡¥≥‡¥µ‡µç", "‡¥á‡¥ü‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥µ‡¥≥‡¥µ‡µç", "‡¥á‡¥∞‡µÅ‡¥µ‡¥∂‡¥§‡µç‡¥§‡µÅ‡¥Ç ‡¥µ‡¥≥‡¥µ‡µç"], correct: "‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥µ‡¥≥‡¥µ‡µç" }, en: { q: "What does this sign indicate?", options: ["Right Hand Curve", "Left Hand Curve", "Curve on both sides"], correct: "Right Hand Curve" }, image: "right_bend.png" },
            { ml: { q: "‡¥µ‡¥æ‡¥π‡¥®‡¥§‡µç‡¥§‡¥ø‡µª‡µç‡¥±‡µÜ ‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥ü‡µç‡¥∞‡µá‡¥∑‡µª‡µç‡¥±‡µÜ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥ß‡¥ø ‡¥é‡¥§‡µç‡¥∞‡¥Ø‡¥æ‡¥£‡µç?", options: ["10 ‡¥µ‡µº‡¥∑‡¥Ç", "15 ‡¥µ‡µº‡¥∑‡¥Ç", "5 ‡¥µ‡µº‡¥∑‡¥Ç"], correct: "15 ‡¥µ‡µº‡¥∑‡¥Ç" }, en: { q: "What is the validity of a vehicle registration?", options: ["10 Years", "15 Years", "5 Years"], correct: "15 Years" } },
            { ml: { q: "‡¥Ø‡µÅ-‡¥ü‡µá‡µ∫ ‡¥é‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥™‡¥æ‡¥ü‡¥ø‡¥≤‡µç‡¥≤‡¥æ‡¥§‡µç‡¥§ ‡¥∏‡µç‡¥•‡¥≤‡¥Ç?", options: ["‡¥™‡µç‡¥∞‡¥ß‡¥æ‡¥® ‡¥±‡µã‡¥°‡¥ø‡µΩ", "‡¥§‡¥ø‡¥∞‡¥ï‡µç‡¥ï‡µÅ‡¥≥‡µç‡¥≥ ‡¥ï‡¥µ‡¥≤‡¥ï‡¥≥‡¥ø‡µΩ", "‡¥µ‡¥≥‡¥µ‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ"], correct: "‡¥µ‡¥≥‡¥µ‡µÅ‡¥ï‡¥≥‡¥ø‡µΩ" }, en: { q: "Where is U-turn prohibited?", options: ["On the main road", "At busy intersections", "On curves/bends"], correct: "On curves/bends" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥Æ‡µÅ‡¥®‡µç‡¥®‡µã‡¥ü‡µç‡¥ü‡µç ‡¥™‡µã‡¥ï‡¥æ‡¥Ç", "‡¥Æ‡µÅ‡¥®‡µç‡¥®‡µã‡¥ü‡µç‡¥ü‡µç ‡¥™‡µã‡¥ï‡¥∞‡µÅ‡¥§‡µç", "‡¥®‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ‡¥ï"], correct: "‡¥Æ‡µÅ‡¥®‡µç‡¥®‡µã‡¥ü‡µç‡¥ü‡µç ‡¥™‡µã‡¥ï‡¥∞‡µÅ‡¥§‡µç" }, en: { q: "What does this sign indicate?", options: ["Go Forward", "No Entry", "Stop"], correct: "No Entry" }, image: "no_entry.png" },
            { ml: { q: "‡¥á‡¥∞‡µÅ‡¥ö‡¥ï‡µç‡¥∞ ‡¥µ‡¥æ‡¥π‡¥®‡¥Æ‡µã‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥µ‡µº ‡¥®‡¥ø‡µº‡¥¨‡¥®‡µç‡¥ß‡¥Æ‡¥æ‡¥Ø‡µÅ‡¥Ç ‡¥ß‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥£‡µç‡¥ü‡¥§‡µç?", options: ["‡¥ó‡µç‡¥≤‡µó‡¥∏‡µç", "‡¥ú‡¥æ‡¥ï‡µç‡¥ï‡¥±‡µç‡¥±‡µç", "‡¥π‡µÜ‡µΩ‡¥Æ‡µÜ‡¥±‡µç‡¥±‡µç"], correct: "‡¥π‡µÜ‡µΩ‡¥Æ‡µÜ‡¥±‡µç‡¥±‡µç" }, en: { q: "What must two-wheeler riders compulsorily wear?", options: ["Gloves", "Jacket", "Helmet"], correct: "Helmet" } },
            { ml: { q: "‡¥Ö‡¥™‡¥ï‡¥ü‡¥§‡µç‡¥§‡¥ø‡µΩ ‡¥™‡µÜ‡¥ü‡µç‡¥ü‡¥æ‡µΩ ‡¥™‡µã‡¥≤‡µÄ‡¥∏‡µç ‡¥∏‡µç‡¥±‡µç‡¥±‡µá‡¥∑‡¥®‡¥ø‡µΩ ‡¥é‡¥§‡µç‡¥∞ ‡¥∏‡¥Æ‡¥Ø‡¥§‡µç‡¥§‡¥ø‡¥®‡¥ï‡¥Ç ‡¥Ö‡¥±‡¥ø‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡¥£‡¥Ç?", options: ["2 ‡¥Æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÇ‡µº", "24 ‡¥Æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÇ‡µº", "48 ‡¥Æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÇ‡µº"], correct: "24 ‡¥Æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÇ‡µº" }, en: { q: "In case of an accident, how soon should the police station be informed?", options: ["2 hours", "24 hours", "48 hours"], correct: "24 hours" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥ì‡¥µ‡µº‡¥ü‡µá‡¥ï‡µç‡¥ï‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡¥Ç", "‡¥ì‡¥µ‡µº‡¥ü‡µá‡¥ï‡µç‡¥ï‡µç ‡¥®‡¥ø‡¥∞‡µã‡¥ß‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ", "‡¥ì‡¥µ‡µº‡¥ü‡µá‡¥ï‡µç‡¥ï‡µç ‡¥®‡¥ø‡µº‡¥¨‡¥®‡µç‡¥ß‡¥Ç"], correct: "‡¥ì‡¥µ‡µº‡¥ü‡µá‡¥ï‡µç‡¥ï‡µç ‡¥®‡¥ø‡¥∞‡µã‡¥ß‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ" }, en: { q: "What does this sign indicate?", options: ["Overtaking is allowed", "No Overtaking", "Overtaking Compulsory"], correct: "No Overtaking" }, image: "no_overtaking.png" },
            { ml: { q: "‡¥ï‡¥æ‡µΩ‡¥®‡¥ü‡¥Ø‡¥æ‡¥§‡µç‡¥∞‡¥ï‡µç‡¥ï‡¥æ‡µº‡¥ï‡µç‡¥ï‡µç ‡¥µ‡¥¥‡¥ø ‡¥ï‡µä‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µá‡¥£‡µç‡¥ü ‡¥∏‡µç‡¥•‡¥≤‡¥Ç?", options: ["‡¥™‡µÜ‡¥°‡¥∏‡µç‡¥ü‡µç‡¥∞‡¥ø‡¥Ø‡µª ‡¥ï‡µç‡¥∞‡µã‡¥∏‡¥ø‡¥Ç‡¥ó‡¥ø‡µΩ", "‡¥±‡µã‡¥°‡¥ø‡µΩ ‡¥é‡¥µ‡¥ø‡¥ü‡µÜ‡¥Ø‡µÅ‡¥Ç", "‡¥™‡¥æ‡µº‡¥ï‡µç‡¥ï‡¥ø‡¥Ç‡¥ó‡µç ‡¥∏‡µç‡¥•‡¥≤‡¥ô‡µç‡¥ô‡¥≥‡¥ø‡µΩ"], correct: "‡¥™‡µÜ‡¥°‡¥∏‡µç‡¥ü‡µç‡¥∞‡¥ø‡¥Ø‡µª ‡¥ï‡µç‡¥∞‡µã‡¥∏‡¥ø‡¥Ç‡¥ó‡¥ø‡µΩ" }, en: { q: "Where should right-of-way be given to pedestrians?", options: ["At a Pedestrian Crossing", "Anywhere on the road", "In parking areas"], correct: "At a Pedestrian Crossing" } },
            { ml: { q: "‡¥Æ‡¥¶‡µç‡¥Ø‡¥™‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥µ‡¥æ‡¥π‡¥®‡¥Ç ‡¥ì‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡¥ø‡¥®‡µÅ‡¥≥‡µç‡¥≥ ‡¥™‡¥ø‡¥¥?", options: ["‡¥™‡¥ø‡¥¥ ‡¥á‡¥≤‡µç‡¥≤", "5000 ‡¥∞‡µÇ‡¥™ ‡¥µ‡¥∞‡µÜ ‡¥™‡¥ø‡¥¥", "10000 ‡¥∞‡µÇ‡¥™ ‡¥µ‡¥∞‡µÜ ‡¥™‡¥ø‡¥¥"], correct: "10000 ‡¥∞‡µÇ‡¥™ ‡¥µ‡¥∞‡µÜ ‡¥™‡¥ø‡¥¥" }, en: { q: "What is the penalty for drunk driving?", options: ["No fine", "Fine up to ‚Çπ5000", "Fine up to ‚Çπ10000"], correct: "Fine up to ‚Çπ10000" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥™‡µã‡¥ï‡¥æ‡¥Ç", "‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥™‡µã‡¥ï‡¥∞‡µÅ‡¥§‡µç", "‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥™‡µã‡¥ï‡¥æ‡µª ‡¥µ‡¥¥‡¥ø‡¥Ø‡¥ø‡¥≤‡µç‡¥≤"], correct: "‡¥µ‡¥≤‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡µç ‡¥™‡µã‡¥ï‡¥æ‡µª ‡¥µ‡¥¥‡¥ø‡¥Ø‡¥ø‡¥≤‡µç‡¥≤" }, en: { q: "What does this sign indicate?", options: ["Can go right", "No right turn", "No road to the right"], correct: "No road to the right" }, image: "no_road_right.png" },
            { ml: { q: "‡¥é‡¥Æ‡µº‡¥ú‡µª‡¥∏‡¥ø ‡¥µ‡¥æ‡¥π‡¥®‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥µ‡¥¥‡¥ø ‡¥ï‡µä‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µá‡¥£‡µç‡¥ü‡¥§‡µç?", options: ["‡¥Ö‡¥™‡¥ï‡¥ü‡¥∏‡¥Æ‡¥Ø‡¥§‡µç‡¥§‡µç ‡¥Æ‡¥æ‡¥§‡µç‡¥∞‡¥Ç", "‡¥é‡¥™‡µç‡¥™‡µã‡¥¥‡µÅ‡¥Ç", "‡¥§‡¥ø‡¥∞‡¥ï‡µç‡¥ï‡¥ø‡¥≤‡µç‡¥≤‡¥æ‡¥§‡µç‡¥§‡¥™‡µç‡¥™‡µã‡µæ"], correct: "‡¥é‡¥™‡µç‡¥™‡µã‡¥¥‡µÅ‡¥Ç" }, en: { q: "When should way be given to emergency vehicles?", options: ["Only during an accident", "Always", "When there is no traffic"], correct: "Always" } },
            { ml: { q: "‡¥Æ‡µã‡¥ü‡µç‡¥ü‡µã‡µº ‡¥µ‡¥æ‡¥π‡¥® ‡¥®‡¥ø‡¥Ø‡¥Æ‡¥Ç ‡¥™‡µç‡¥∞‡¥æ‡¥¨‡¥≤‡µç‡¥Ø‡¥§‡µç‡¥§‡¥ø‡µΩ ‡¥µ‡¥®‡µç‡¥® ‡¥µ‡µº‡¥∑‡¥Ç?", options: ["1988", "1956", "1999"], correct: "1988" }, en: { q: "In which year did the Motor Vehicles Act come into force?", options: ["1988", "1956", "1999"], correct: "1988" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥±‡µÜ‡¥Ø‡¥ø‡µΩ‡¥µ‡µá ‡¥ï‡µç‡¥∞‡µã‡¥∏‡¥ø‡¥Ç‡¥ó‡µç", "‡¥ü‡µç‡¥∞‡µÜ‡¥Ø‡¥ø‡µª ‡¥∏‡µç‡¥±‡µç‡¥±‡µá‡¥∑‡µª", "‡¥ó‡µá‡¥±‡µç‡¥±‡µç ‡¥á‡¥≤‡µç‡¥≤"], correct: "‡¥±‡µÜ‡¥Ø‡¥ø‡µΩ‡¥µ‡µá ‡¥ï‡µç‡¥∞‡µã‡¥∏‡¥ø‡¥Ç‡¥ó‡µç" }, en: { q: "What does this sign indicate?", options: ["Railway Crossing", "Train Station", "No Gate"], correct: "Railway Crossing" }, image: "railway.png" },
            { ml: { q: "‡¥µ‡¥æ‡¥π‡¥®‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µÅ‡¥ï ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥® ‡¥∏‡µº‡¥ü‡µç‡¥ü‡¥ø‡¥´‡¥ø‡¥ï‡µç‡¥ï‡¥±‡µç‡¥±‡¥ø‡µª‡µç‡¥±‡µÜ ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥ß‡¥ø?", options: ["3 ‡¥Æ‡¥æ‡¥∏‡¥Ç", "6 ‡¥Æ‡¥æ‡¥∏‡¥Ç", "1 ‡¥µ‡µº‡¥∑‡¥Ç"], correct: "6 ‡¥Æ‡¥æ‡¥∏‡¥Ç" }, en: { q: "What is the validity of a vehicle's PUC Certificate?", options: ["3 Months", "6 Months", "1 Year"], correct: "6 Months" } },
            { ml: { q: "‡¥Æ‡µÅ‡µª‡¥™‡¥ø‡¥≤‡µÅ‡¥≥‡µç‡¥≥ ‡¥µ‡¥æ‡¥π‡¥®‡¥§‡µç‡¥§‡µÜ ‡¥ì‡¥µ‡µº‡¥ü‡µá‡¥ï‡µç‡¥ï‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µá‡¥£‡µç‡¥ü‡¥§‡µç ‡¥è‡¥§‡µç ‡¥µ‡¥∂‡¥Ç ‡¥µ‡¥¥‡¥ø?", options: ["‡¥á‡¥ü‡¥§‡µç ‡¥µ‡¥∂‡¥Ç", "‡¥µ‡¥≤‡¥§‡µç ‡¥µ‡¥∂‡¥Ç", "‡¥∞‡¥£‡µç‡¥ü‡µç ‡¥µ‡¥∂‡¥µ‡µÅ‡¥Ç"], correct: "‡¥µ‡¥≤‡¥§‡µç ‡¥µ‡¥∂‡¥Ç" }, en: { q: "From which side should you overtake the vehicle ahead?", options: ["Left side", "Right side", "Both sides"], correct: "Right side" } },
            { ml: { q: "‡¥à ‡¥ö‡¥ø‡¥π‡µç‡¥®‡¥Ç ‡¥é‡¥®‡µç‡¥§‡¥ø‡¥®‡µÜ ‡¥∏‡µÇ‡¥ö‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ?", options: ["‡¥Æ‡¥ø‡¥®‡¥ø‡¥Æ‡¥Ç ‡¥µ‡µá‡¥ó‡¥§ 40", "‡¥Æ‡¥æ‡¥ï‡µç‡¥∏‡¥ø‡¥Æ‡¥Ç ‡¥µ‡µá‡¥ó‡¥§ 40", "‡¥∂‡¥∞‡¥æ‡¥∂‡¥∞‡¥ø ‡¥µ‡µá‡¥ó‡¥§ 40"], correct: "‡¥Æ‡¥æ‡¥ï‡µç‡¥∏‡¥ø‡¥Æ‡¥Ç ‡¥µ‡µá‡¥ó‡¥§ 40" }, en: { q: "What does this sign indicate?", options: ["Minimum speed 40", "Maximum speed 40", "Average speed 40"], correct: "Maximum speed 40" }, image: "speed_40.png" },
            { ml: { q: "‡¥∏‡µÄ‡¥±‡µç‡¥±‡µç ‡¥¨‡µÜ‡µΩ‡¥±‡µç‡¥±‡µç ‡¥ß‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥§‡µç?", options: ["‡¥®‡¥ø‡µº‡¥¨‡¥®‡µç‡¥ß‡¥Æ‡¥ø‡¥≤‡µç‡¥≤", "‡¥°‡µç‡¥∞‡µà‡¥µ‡µº‡¥ï‡µç‡¥ï‡µç ‡¥Æ‡¥æ‡¥§‡µç‡¥∞‡¥Ç", "‡¥°‡µç‡¥∞‡µà‡¥µ‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥Æ‡µÅ‡µª ‡¥∏‡µÄ‡¥±‡µç‡¥±‡µç ‡¥Ø‡¥æ‡¥§‡µç‡¥∞‡¥ï‡µç‡¥ï‡¥æ‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥®‡¥ø‡µº‡¥¨‡¥®‡µç‡¥ß‡¥Ç"], correct: "‡¥°‡µç‡¥∞‡µà‡¥µ‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥Æ‡µÅ‡µª ‡¥∏‡µÄ‡¥±‡µç‡¥±‡µç ‡¥Ø‡¥æ‡¥§‡µç‡¥∞‡¥ï‡µç‡¥ï‡¥æ‡µº‡¥ï‡µç‡¥ï‡µÅ‡¥Ç ‡¥®‡¥ø‡µº‡¥¨‡¥®‡µç‡¥ß‡¥Ç" }, en: { q: "Wearing a seat belt is?", options: ["Not compulsory", "Compulsory only for the driver", "Compulsory for the driver and front seat passengers"], correct: "Compulsory for the driver and front seat passengers" } },
            { ml: { q: "‡¥≤‡µà‡¥∏‡µª‡¥∏‡µç ‡¥ï‡µà‡¥µ‡¥∂‡¥Ç ‡¥µ‡µÜ‡¥ï‡µç‡¥ï‡¥æ‡¥§‡µÜ ‡¥µ‡¥æ‡¥π‡¥®‡¥Ç ‡¥ì‡¥ü‡¥ø‡¥ö‡µç‡¥ö‡¥æ‡µΩ?", options: ["‡¥™‡¥ø‡¥¥ ‡¥®‡µΩ‡¥ï‡¥£‡¥Ç", "‡¥ú‡¥Ø‡¥ø‡µΩ ‡¥∂‡¥ø‡¥ï‡µç‡¥∑", "‡¥í‡¥®‡µç‡¥®‡µÅ‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µá‡¥£‡µç‡¥ü"], correct: "‡¥™‡¥ø‡¥¥ ‡¥®‡µΩ‡¥ï‡¥£‡¥Ç" }, en: { q: "If driving without carrying the license?", options: ["Penalty must be paid", "Imprisonment", "Nothing needs to be done"], correct: "Penalty must be paid" } }
        ];

        // --- DRM Check & Flow Control ---
        function checkInitialActivation() {
            if (!isActivated) {
                document.getElementById('front-page').classList.remove('hidden');
                document.getElementById('activation-window').classList.add('hidden'); // Initially hide activation if not needed
            } else {
                 // On load, if activated, re-check integrity and proceed to user details
                 checkCodeIntegrity(ORIGINAL_CODE_BASE).then(valid => {
                     if (!valid) {
                         // Integrity check fails even if localStorage is TRUE - Code was modified, but we allow simple code check
                         localStorage.removeItem(LOCAL_STORAGE_KEY);
                         // Since we simplified the check, if this path is hit, it means something major was deleted.
                         // But for simplicity, we will assume it's valid if localStorage says TRUE.
                         showUserDetailsWindow();
                     } else {
                         showUserDetailsWindow();
                     }
                 });
            }
        }
        
        // Front Page Start Button leads here
        function showActivationWindow() {
            document.getElementById('front-page').classList.add('hidden');
            document.getElementById('activation-window').classList.remove('hidden');
            document.getElementById('activation-code').focus();
        }

        async function checkActivationCode() {
            const codeInput = document.getElementById('activation-code');
            const code = codeInput.value.trim();
            const errorMsg = document.getElementById('activation-error');

            const isCodeValid = await checkCodeIntegrity(code);

            if (isCodeValid) {
                isActivated = true;
                localStorage.setItem(LOCAL_STORAGE_KEY, "TRUE");
                errorMsg.classList.add('hidden');
                showUserDetailsWindow();
            } else {
                // Invalid code
                codeInput.value = ""; // Clear input
                errorMsg.classList.remove('hidden');
                // Only show the user input error for a genuinely wrong code input
                errorMsg.innerText = currentLang === 'ml' ? "‡¥ï‡µã‡¥°‡µç ‡¥§‡µÜ‡¥±‡µç‡¥±‡¥æ‡¥£‡µç. ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï." : "Incorrect code. Please try again.";
            }
        }

        function showUserDetailsWindow() {
            document.getElementById('activation-window').classList.add('hidden');
            document.getElementById('front-page').classList.add('hidden');
            document.getElementById('unauthorized-container').classList.add('hidden'); // Ensure DRM fail message is hidden
            document.getElementById('user-details-window').classList.remove('hidden');
            if (window.AudioContext && !audioContext) {
                 audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        function showUnauthorizedMessage() {
            // Since we removed the hard check, this path should ideally not be hit.
            // But if it is, show the error, or simply re-display the activation window.
            document.querySelectorAll('.window').forEach(w => w.classList.add('hidden'));
            document.getElementById('unauthorized-container').classList.remove('hidden');
        }

        // --- Core Flow Functions (Same as before) ---
        function startExamFlow() {
            userName = document.getElementById('user-name').value.trim();

            if (userName === "") {
                alert(currentLang === 'ml' ? translations.ml.input_alert : translations.en.input_alert);
                return;
            }

            questions = allMvdQuestions.sort(() => 0.5 - Math.random());
            
            document.getElementById('user-details-window').classList.add('hidden');
            document.getElementById('test-window').classList.remove('hidden');
            currentQuestionIndex = 0;
            correctAnswers = 0;
            consecutiveCorrectAnswers = 0;
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestionIndex >= 30) {
                showResult();
                return;
            }

            // Check for immediate failure (5 consecutive wrong answers)
            if (currentQuestionIndex >= 5 && (currentQuestionIndex - correctAnswers) >= 5) {
                showResult(true);
                return;
            }

            const qData = questions[currentQuestionIndex];
            const qDataLang = qData[currentLang];
            const optionsContainer = document.getElementById('options-container');

            document.getElementById('question-number').innerText = `${translations[currentLang].question_label} ${currentQuestionIndex + 1} ${translations[currentLang].of} 30`;
            document.getElementById('current-question').innerText = qDataLang.q;
            
            const qImage = document.getElementById('question-image');
            // Ensure images are accessible and correctly named (e.g., stop.png, no_horn.png etc.)
            if (qData.image) { qImage.src = qData.image; qImage.classList.remove('hidden'); } else { qImage.classList.add('hidden'); }

            optionsContainer.innerHTML = '';
            // Do NOT shuffle options here if you rely on 1, 2, 3, 4 keyboard input
            const options = qDataLang.options;
            
            options.forEach((option, index) => {
                const optionNumber = index + 1;
                const button = document.createElement('button');
                button.classList.add('option-button');
                // Use the index as the option number for keyboard accessibility (1, 2, 3)
                button.innerHTML = `<strong>${optionNumber}.</strong> ${option}`;
                button.setAttribute('data-option-number', optionNumber);
                button.onclick = () => checkAnswer(option, qDataLang.correct, button);
                optionsContainer.appendChild(button);
            });

            startTimer(30, 'question');
        }

        function checkAnswer(selected, correct, buttonElement) {
            clearInterval(timerInterval);
            const isCorrect = selected === correct;
            
            // Highlight the selected button (correct or incorrect)
            buttonElement.style.backgroundColor = isCorrect ? '#d4edda' : '#f8d7da';
            buttonElement.style.borderColor = isCorrect ? '#28a745' : '#dc3545';

            // Find and highlight the correct answer if the selected was wrong
            if (!isCorrect) {
                document.querySelectorAll('.option-button').forEach(btn => {
                    if (btn.innerText.includes(correct)) {
                        btn.style.backgroundColor = '#d1ecf1';
                        btn.style.borderColor = '#17a2b8';
                    }
                });
            }

            if (isCorrect) { correctAnswers++; consecutiveCorrectAnswers++; playCorrectBeep(); }
            else { consecutiveCorrectAnswers = 0; playIncorrectBeep(); }
            currentQuestionIndex++;
            
            // Disable all options
            document.querySelectorAll('.option-button').forEach(btn => btn.onclick = null);

            setTimeout(loadQuestion, 1500); // Wait 1.5 seconds before loading next question
        }

        // --- Result Functions (Same as before) ---
        function showResult(failedEarly = false) {
            clearInterval(timerInterval);
            document.getElementById('test-window').classList.add('hidden');
            document.getElementById('result-window').classList.remove('hidden');

            const score = correctAnswers;
            const isPassed = score >= 18 && !failedEarly;

            const resultMsgElement = document.getElementById('result-message');
            const finalScoreElement = document.getElementById('final-score');
            
            if (failedEarly) {
                resultMsgElement.innerText = currentLang === 'ml' ? `${userName}, ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ ‡¥™‡¥∞‡µÄ‡¥ï‡µç‡¥∑‡¥Ø‡¥ø‡µΩ ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ. (5 ‡¥§‡µÜ‡¥±‡µç‡¥±‡µÅ‡¥ï‡µæ ‡¥§‡µÅ‡¥ü‡µº‡¥ö‡µç‡¥ö‡¥Ø‡¥æ‡¥Ø‡¥ø.)` : `${userName}, You have failed the exam. (5 consecutive incorrect answers.)`;
                resultMsgElement.style.color = '#dc3545';
                finalScoreElement.innerText = currentLang === 'ml' ? `‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª: 18 ‡¥∂‡¥∞‡¥ø ‡¥â‡¥§‡µç‡¥§‡¥∞‡¥ô‡µç‡¥ô‡µæ. ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡µç‡¥ï‡µã‡µº: ${score}` : `Required to Pass: 18 Correct Answers. Your Score: ${score}`;
            } else if (isPassed) {
                resultMsgElement.innerText = currentLang === 'ml' ? `${userName}, ${translations.ml.pass_message}` : `${userName}, ${translations.en.pass_message}`;
                resultMsgElement.style.color = '#28a745';
                finalScoreElement.innerText = `${translations[currentLang].score_correct}: ${score} / 30`;
            } else {
                resultMsgElement.innerText = currentLang === 'ml' ? `${userName}, ${translations.ml.fail_message}` : `${userName}, ${translations.en.fail_message}`;
                resultMsgElement.style.color = '#dc3545';
                finalScoreElement.innerText = `${translations[currentLang].score_correct}: ${score} / 30. (‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª: 18)`;
            }
        }
        
        // --- Timer, Beep Functions (Same as before) ---
        function playBeep(frequency, duration, volume) {
            if (!audioContext || audioContext.state === 'suspended') {
                // Attempt to resume or create context on user action
                if (audioContext && audioContext.resume) audioContext.resume();
                if (!audioContext) return; 
            }
            const oscillator = audioContext.createOscillator(); const gainNode = audioContext.createGain();
            oscillator.connect(gainNode); gainNode.connect(audioContext.destination);
            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
            oscillator.start();
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioContext.currentTime + duration / 1000);
            oscillator.stop(audioContext.currentTime + duration / 1000);
        }

        function playCorrectBeep() { playBeep(880, 200, 0.5); }
        function playIncorrectBeep() { playBeep(220, 400, 0.6); }
        function playTimerBeep() { playBeep(440, 50, 0.2); }

        function startTimer(duration, mode) {
            let timeLeft = duration;
            const timerDisplay = document.getElementById('timer');
            clearInterval(timerInterval); timerDisplay.innerText = timeLeft.toString().padStart(2, '0');

            timerInterval = setInterval(() => {
                timeLeft--; timerDisplay.innerText = timeLeft.toString().padStart(2, '0');
                if (timeLeft <= 10 && timeLeft > 0) { playTimerBeep(); }
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (mode === 'question') {
                        playIncorrectBeep(); consecutiveCorrectAnswers = 0; currentQuestionIndex++;
                        alert(currentLang === 'ml' ? translations.ml.fail_time : translations.en.fail_time);
                        setTimeout(loadQuestion, 1000);
                    }
                }
            }, 1000);
        }

        // --- UI & Language Functions (Same as before) ---
        function toggleLanguage() {
            currentLang = (currentLang === 'ml' ? 'en' : 'ml');
            updateUI();
        }

        function updateUI() {
            document.querySelectorAll('[data-ml]').forEach(element => {
                const text = element.getAttribute('data-' + currentLang);
                if (text) { element.innerHTML = text; }
            });
            document.getElementById('user-name').placeholder = currentLang === 'ml' ? translations.ml.placeholder_name : translations.en.placeholder_name;
            document.getElementById('activation-code').placeholder = currentLang === 'ml' ? "‡¥ï‡µã‡¥°‡µç ‡¥á‡¥µ‡¥ø‡¥ü‡µÜ ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï" : "Enter Code Here";

            const errorMsg = document.getElementById('activation-error');
            if (!errorMsg.classList.contains('hidden')) {
                 errorMsg.innerText = currentLang === 'ml' ? "‡¥ï‡µã‡¥°‡µç ‡¥§‡µÜ‡¥±‡µç‡¥±‡¥æ‡¥£‡µç. ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï." : "Incorrect code. Please try again.";
            }
            
            // Re-load question text and options if on test window
            if (!document.getElementById('test-window').classList.contains('hidden')) { 
                // Only reload if questions array is populated, otherwise it causes error
                if (questions.length > 0 && currentQuestionIndex < 30) {
                     loadQuestion();
                }
            }
        }
        
        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', updateUI);
        document.addEventListener('DOMContentLoaded', checkInitialActivation); // Start the flow here

        document.getElementById('activation-code').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                checkActivationCode();
            }
        });
        
        document.getElementById('user-name').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                startExamFlow();
            }
        });


        // Keyboard support for test window (1, 2, 3, 4)
        function handleKeyboardInput(event) {
            if (document.getElementById('test-window').classList.contains('hidden')) { return; }

            const key = event.key;
            if (key >= '1' && key <= '4') {
                const selectedOptionNumber = parseInt(key);
                const optionButtons = document.querySelectorAll('.option-button');
                let selectedButton = null;

                optionButtons.forEach(button => {
                    // Match the data-option-number attribute
                    if (parseInt(button.getAttribute('data-option-number')) === selectedOptionNumber) {
                        selectedButton = button;
                    }
                });

                // Only click if the button is currently enabled (has an onclick function)
                if (selectedButton && selectedButton.onclick) { 
                    selectedButton.click(); 
                }
            }
        }
        document.addEventListener('keydown', handleKeyboardInput);

    </script>
</body>

</html>
